log to file test/3-2-4/log.txt, logger name is 3-2-4
{'gamma': 3.0, 'reward_param': 1.0, 'providers': [{'id': 0, 'num_models': 3, 'eta': 0.9, 'models': ['gpt-5-high', 'deepseek-r1', 'gpt-5-medium'], 'strategy': 3, 'reward_param': 1.0}, {'id': 1, 'num_models': 3, 'eta': 0.9, 'models': ['o3-mini', 'o1-mini', 'deepseek-r1'], 'strategy': 2, 'reward_param': 1.0}, {'id': 2, 'num_models': 3, 'eta': 0.9, 'models': ['claude-4-0', 'o1-mini', 'deepseek-r1'], 'strategy': 4, 'reward_param': 1.0}], 'path': 'config/nl_graph/yuhan1.yaml', 'eps': 0.3, 'num_tasks': 1000000.0, 'B': 3981, 'K': 3, 'M': 0.23637291771156435, 'output_dir': 'test/3-2-4'}
init provider 0
['gpt-5-medium', 'gpt-5-high', 'deepseek-r1']
init provider 1
['o3-mini', 'o1-mini', 'deepseek-r1']
init provider 2
['o1-mini', 'claude-4-0', 'deepseek-r1']
L is 38058
delta_1=11.1958, delta_2=0.0000
====================Stage1: Delegate each provider 3981 Times====================
Delegate provider 0 3981 tasks.
Delegate provider 1 3981 tasks.
Delegate provider 2 3981 tasks.
Providers sorted by avg_user_utility: [2, 1, 0]
Provider 0 avg_user_utility: 0.9210
Provider 0 avg_provider_utility: 0.0000
Provider 1 avg_user_utility: 0.7448
Provider 1 avg_provider_utility: 0.0000
Provider 2 avg_user_utility: 0.3620
Provider 2 avg_provider_utility: 0.1314
  阶段1完成，最佳服务商：0，平均效用：0.9210
  第二好服务商1	 第二好效用：0.7448



====================phase1_exploration end====================


====================Provider-0 History Info:==================
total input_tokens: 9167125.0
avg input_tokens: 2302.719166038684
total output_tokens: 26443573.0
avg output_tokens: 6642.444863099724
total reported_output_tokens: 26443573.0
avg reported_output_tokens: 6642.444863099724
total reported_price: 275.8946362500001
avg reported_price: 0.06930284758854562
total costs: 248.305172625
avg costs: 0.06237256282969104
total rewards: 3942.4466999571887
avg rewards: 0.9903156744429009
total user_utility: 3666.552063707189
avg user_utility: 0.9210128268543555
total provider_utility: 0.0
avg provider_utility: 0.0


====================Provider-1 History Info:==================
total input_tokens: 9103368.0
avg input_tokens: 2286.7038432554637
total output_tokens: 33329829.0
avg output_tokens: 8372.22532027129
total reported_output_tokens: 33329829.0
avg reported_output_tokens: 8372.22532027129
total reported_price: 156.6649524
avg reported_price: 0.039353165636774684
total costs: 140.99845716000002
avg costs: 0.03541784907309722
total rewards: 3121.577813462206
avg rewards: 0.7841190187043974
total user_utility: 2964.9128610622056
avg user_utility: 0.7447658530676226
total provider_utility: 0.0
avg provider_utility: 0.0


====================Provider-2 History Info:==================
total input_tokens: 9114102.0
avg input_tokens: 2289.4001507159005
total output_tokens: 43086373.0
avg output_tokens: 10823.002511931676
total reported_output_tokens: 151508898.0
avg reported_output_tokens: 38058.0
total reported_price: 676.6646634000001
avg reported_price: 0.16997354016578753
total costs: 86.071618035
avg costs: 0.021620602370007534
total rewards: 2117.8009415114266
avg rewards: 0.5319771267298233
total user_utility: 1441.136278111427
avg user_utility: 0.3620035865640359
total provider_utility: 522.9265790249999
avg provider_utility: 0.13135558377920117



====================phase2_exploitation start====================
后面的东西是：0.10877724091141051
Phase2 delta_3 components | provider 1: avg_reward=0.7841, avg_output_tokens=8372.23
Phase2 delta_3 components | provider 2: avg_reward=0.5320, avg_output_tokens=38058.00
delta_1 = 11.195840192374956
delta_2 = 0.0
delta_3 = -21.67387678455875
R = T - ((delta_1 + 3) * K + delta_2 + delta_3) * B = 1000000 - ((11.195840192374956 + 3) * 3 + 0.0 + -21.67387678455875) * 3981 = 916742.7840617943
  计划委托916742次，阈值：0.6360
  早停触发：最近7962次平均用户效用 0.6086 < 阈值 0.6360
  在7962次委托后停止，总provider_utility：2246.3807



====================phase2_exploitation end====================


====================Provider-0 History Info:==================
total input_tokens: 27525329.0
avg input_tokens: 2304.7248597504813
total output_tokens: 79863519.0
avg output_tokens: 6687.0567696558655
total reported_output_tokens: 329461369.0
avg reported_output_tokens: 27586.148287699907
total reported_price: 3329.02035125
avg reported_price: 0.2787423889516872
total costs: 749.737666125
avg costs: 0.06277632639412209
total rewards: 11841.023542172283
avg rewards: 0.9914614035143835
total user_utility: 8512.003190922282
avg user_utility: 0.7127190145626963
total provider_utility: 2246.38065
avg provider_utility: 0.18809182366239638


====================Provider-1 History Info:==================
total input_tokens: 9103368.0
avg input_tokens: 2286.7038432554637
total output_tokens: 33329829.0
avg output_tokens: 8372.22532027129
total reported_output_tokens: 33329829.0
avg reported_output_tokens: 8372.22532027129
total reported_price: 156.6649524
avg reported_price: 0.039353165636774684
total costs: 140.99845716000002
avg costs: 0.03541784907309722
total rewards: 3121.577813462206
avg rewards: 0.7841190187043974
total user_utility: 2964.9128610622056
avg user_utility: 0.7447658530676226
total provider_utility: 0.0
avg provider_utility: 0.0


====================Provider-2 History Info:==================
total input_tokens: 9114102.0
avg input_tokens: 2289.4001507159005
total output_tokens: 43086373.0
avg output_tokens: 10823.002511931676
total reported_output_tokens: 151508898.0
avg reported_output_tokens: 38058.0
total reported_price: 676.6646634000001
avg reported_price: 0.16997354016578753
total costs: 86.071618035
avg costs: 0.021620602370007534
total rewards: 2117.8009415114266
avg rewards: 0.5319771267298233
total user_utility: 1441.136278111427
avg user_utility: 0.3620035865640359
total provider_utility: 522.9265790249999
avg provider_utility: 0.13135558377920117



====================phase2_incentive start====================
====================Stage2 Incentive: Delegate non-best providers 3981 Times each====================
Delegate provider 1 3981 tasks.
Delegate provider 2 3981 tasks.


====================Provider-0 History Info:==================
total input_tokens: 27525329.0
avg input_tokens: 2304.7248597504813
total output_tokens: 79863519.0
avg output_tokens: 6687.0567696558655
total reported_output_tokens: 329461369.0
avg reported_output_tokens: 27586.148287699907
total reported_price: 3329.02035125
avg reported_price: 0.2787423889516872
total costs: 749.737666125
avg costs: 0.06277632639412209
total rewards: 11841.023542172283
avg rewards: 0.9914614035143835
total user_utility: 8512.003190922282
avg user_utility: 0.7127190145626963
total provider_utility: 2246.38065
avg provider_utility: 0.18809182366239638


====================Provider-1 History Info:==================
total input_tokens: 18214950.0
avg input_tokens: 2287.735493594574
total output_tokens: 76650754.0
avg output_tokens: 9627.07284601859
total reported_output_tokens: 184838727.0
avg reported_output_tokens: 23215.112660135645
total reported_price: 833.3268438000001
avg reported_price: 0.10466300474755089
total costs: 227.53205966700003
avg costs: 0.028577249392991715
total rewards: 5303.312935594777
avg rewards: 0.666077987389447
total user_utility: 4469.986091794777
avg user_utility: 0.5614149826418962
total provider_utility: 522.4620997530001
avg provider_utility: 0.06561945487980408


====================Provider-2 History Info:==================
total input_tokens: 18222174.0
avg input_tokens: 2288.64280331575
total output_tokens: 86298309.0
avg output_tokens: 10838.772795779954
total reported_output_tokens: 303017796.0
avg reported_output_tokens: 38058.0
total reported_price: 1353.3226938
avg reported_price: 0.16997270708364734
total costs: 172.389960963
avg costs: 0.021651590173700073
total rewards: 4240.175420374514
avg rewards: 0.5325515473969498
total user_utility: 2886.852726574514
avg user_utility: 0.3625788403133024
total provider_utility: 1045.6004634570002
avg provider_utility: 0.13132384620158255



====================phase2_incentive end====================



====================phase3_utility_based start====================
for provider 0: log_avg_reward=-0.009731523605889941, log_avg_output_tokens=8.801235376974711, avg_output_tokens/L = 0.17453478540910516, L=38058
delta_1=11.195840192374956
for provider 0: avg_reward:0.9903156744429009, avg_output_tokens: 6642.444863099724, delta: 2.2103385063852494
delta: 2.2103385063852494
provider 0: 计划委托次数 8799 (整数部分)
provider 0: 被委托了8799次: 收了provider_utility:2845.6528931190005
for provider 1: log_avg_reward=-0.24319446058170077, log_avg_output_tokens=9.032674996757393, avg_output_tokens/L = 0.2199859509241497, L=38058
delta_1=11.195840192374956
for provider 1: avg_reward:0.7841190187043974, avg_output_tokens: 8372.22532027129, delta: 1.699984784111711
delta: 1.699984784111711
provider 1: 计划委托次数 6767 (整数部分)
provider 1: 被委托了6767次: 收了provider_utility:888.192406161
for provider 2: log_avg_reward=-0.6311547854335516, log_avg_output_tokens=10.546866590861953, avg_output_tokens/L = 1.0, L=38058
delta_1=11.195840192374956
for provider 2: avg_reward:0.5319771267298233, avg_output_tokens: 38058.0, delta: -0.9821811839205488
delta: -0.9821811839205488
provider 2: delta<=0，不进行委托


====================Provider-0 History Info:==================
total input_tokens: 47662412.0
avg input_tokens: 2297.8696364863563
total output_tokens: 175406457.0
avg output_tokens: 8456.583598495805
total reported_output_tokens: 664333711.0
avg reported_output_tokens: 32028.430768489055
total reported_price: 6702.915125
avg reported_price: 0.32315664473049854
total costs: 940.590069381
avg costs: 0.045347125126844086
total rewards: 16616.838305468882
avg rewards: 0.8011203502781257
total user_utility: 9913.92318046888
avg user_utility: 0.47796370554762707
total provider_utility: 5092.033543119001
avg provider_utility: 0.2454938551306046


====================Provider-1 History Info:==================
total input_tokens: 33688364.0
avg input_tokens: 2287.213252766651
total output_tokens: 150232199.0
avg output_tokens: 10199.755516328332
total reported_output_tokens: 442377213.0
avg reported_output_tokens: 30034.43635005771
total reported_price: 1983.5169376000001
avg reported_price: 0.13466745451829726
total costs: 374.51073792600005
avg costs: 0.02542675931332745
total rewards: 8950.456233749017
avg rewards: 0.6076757576039797
total user_utility: 6966.9392961490175
avg user_utility: 0.4730083030856825
total provider_utility: 1410.6545059139999
avg provider_utility: 0.09577394975314005


====================Provider-2 History Info:==================
total input_tokens: 18222174.0
avg input_tokens: 2288.64280331575
total output_tokens: 86298309.0
avg output_tokens: 10838.772795779954
total reported_output_tokens: 303017796.0
avg reported_output_tokens: 38058.0
total reported_price: 1353.3226938
avg reported_price: 0.16997270708364734
total costs: 172.389960963
avg costs: 0.021651590173700073
total rewards: 4240.175420374514
avg rewards: 0.5325515473969498
total user_utility: 2886.852726574514
avg user_utility: 0.3625788403133024
total provider_utility: 1045.6004634570002
avg provider_utility: 0.13132384620158255



====================phase3_utility_based end====================
